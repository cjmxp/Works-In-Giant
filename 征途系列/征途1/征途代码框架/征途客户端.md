# 征途客户端
## 架构部分

![](./_image/IMG_20180921_185011.jpg)

## 客户端代码部分
-  征途引擎里面的**update函数，叫做Render**，就是每帧进行渲染的。
- 按钮，输入框，复选，滑动条等等UI，都是自己重写过定义的，一个场景中的全部UI（包括文字）都在一个Vector里面，然后你鼠标点击了一个地方后，发送对应的信息，会遍历这个Vector(nControlType)，如果你点的位置是一个UI，会触发对应的UI事件，不然就返回一个NULL。
- GuiStatic.h和GuiPublic.h两个头文件里面包含了一本的屏幕适配，UI获取，一些公共的东西。SetText什么的。GuiDialog里面包含了提取所有这些东西的函数，包括GetTab,GetScrollText,GetText什么的。方法是一样的，初步认为是导入场景后，会在初始化时把这些场景中的UI全部给放到vector里面去。
- .pak文件是图包文件，.xml是配置文件，.tbl是数据库表格文件。分别归属美术，客户端，策划岗位使用格式文件。pak通过MakeGLNew，tbl通过ExcelMakePack（这些文件所包含的内容可以看汪大的客户端参考手册）
## 监听按键
- EngineState的GetKeyState（int nVirtKey）这个函数监听你键盘上的按键情况。
- 还有一个监听鼠标，在GuiFairyActivitorList里面用委托构造，向GuiDialogEx基类进行鼠标点击事件的注册。每一个Gui都是继承的这个GuiDialogEx，里面有一个protect的map，里面有监听的物体和事件。这个基类封装了相关UI的处理，键盘的处理，包括软键盘的处理。（鼠标的监听是基类就写好的）
- ## 代码细节相关
- C++条件编译。有一个#if 1和#if 0；常见的#ifdef #else和#ifndef #else最后的#endif注意这些最后都要有一个匹配的#endif。
- 这个条件编译，有点类似我们一开始的标志物flag，都是判定是否需要编译一次或者需要特定时间重复编译。
- **新建的对话框都是建议继承CGuiDialogEx，不要用老的CGuiDialog。可以减少大量的方便，不用再GameGuiManager中创建对应的指针，创建函数，也不用考虑在Dialog OnCloese的时候清空对话框指针。减少了代码量。**

## 细节
- 场景中的背景图大小是1024*1024
- 游戏中的场景动画都是帧动画
- Cliend->Client_UB30里面的东西是用来联合编译的，加快程序编译速度。还有另一个作用，就是游戏是默认用这个启动的，如果你不把新写的.cpp文件写到这里面，就会报错。
- 有一个九屏的渲染思想。一个屏幕9*16的大小，然后这样9个屏幕，玩家处于最中心的位置，这样只需要渲染包括自己在内的九个屏幕即可，然后玩家移动到九屏中的另一个屏幕，删除看不到的后面三屏，重新渲染绘制新五屏。