[TOC]
# 个性界面
**不同的版本之间，差异非常的大，尤其是重制版和免费版。**

## 读取配置

- 首先都是读取配置，配置的位置是在几个地方，一个是魔盒（重制版实际上没有魔盒）展示中的配置来源于`CommonConfigManager.cpp`中的魔盒配置部分，注意如果新加的配置在xml文件不能乱放，是在magicboxcfg的二级字段下的。这个配置里面有用于展示的动画部分。

## 管理器调用配置
**代码部分，不同的版本区别有不少。**

- 免费版部分：对于不同的魔盒内的品种种类，如有足迹，头像，称号，个性界面等。都是有不同的管理器来管理的，比如有`MagicBoxTitleItemManager,MagicBoxFootItemManager,MagicBoxAccessoryManager,MagicBoxCDlgManager`等。这些管理器用来**保存进阶的属性Item数据结构，显示的悬浮配置，玩家拥有的物品，以及在配置中遍历用来查看玩家是否拥有，利用ID返回type以及反之**，不同点在于，免费版的魔盒界面都是在一个`GuiMagicBoxDlg.h`里面。也就是每一个不同物品的Item结构都定义在了这里面。

- 重制版部分：重制版的界面，与重制版的魔盒界面大不相同，他的不同种类Item是定义在不同的地方的，但是管理器是一样的。有的地方比如翅膀，称号，个性界面是点击后单独打开一个新的Dialog界面，所以不同的Item数据结构也就是在不同的地方定义。而且这些界面的cpp文件命名也不正规，不是Dlg结尾的。比如头像就直接是`GuiFaceCard.cpp`。

## 客户端点击展示
- 点击之后，就是进行展示部分，这个都是在一张什么都没有的地图上进行动态创建基础的图片，然后updateUI的时候利用管理器进行配置排序展示，位置都是代码里面进行具体的写死数字调整的。

## 点击道具进行替换
- 道具的使用，在`RoleItem_Table.cpp`里面都是类似的处理，判断是否能进阶，不同之处在于进阶的Dialog在重制版更加的具体，花里胡哨。需要额外的读取配置信息。
- 使用之后，会根据玩家的选择发送替换的消息，消息返回之后进行替换，就是简单的根据autocommonconfig.xml里面的配置进行替换。注意与图包位置的一致。