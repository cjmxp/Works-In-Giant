# 第十一周学习周报
> 时间：2018/11/26-2018/11/30
> 作者：卢陈侃

## 工作情况
1. 跟进免费版自动使用经验丹的后续处理，对特殊情况的优化，最后转化为每次启动游戏进入帐号时进入对应的使用经验丹流程，不过大小退无法自动使用经验丹。
2. 完成往重制版迁移免费版的动态界面的功能，等待美术完成画图打包进图包。
3. 完成天气等级排行榜功能添加。
4. 完成免费版修正闪避统计数值。
5. 调查和修改优化排行榜初始化时没有滚动条问题。 
6. 额外了解了一部分挖宝的代码部分。

## 遇到问题及反思
1. 经验丹的使用情况，QA考虑了一个特殊的情况，会有半夜跨0点的玩家，由于那段时间服务器发送的消息比较忙，所以自动使用经验丹会有延迟，如果这个时候下线，就会出现问题，而且这个过程，QA是视为玩家未下线的，所以也不能自动使用经验丹；除此之外，状态清除重置消息和这个消息可能先后顺序不按正常逻辑，即使服务器那边修改消息的发送顺序，也有可能会由于Character的消息缓存机制，执行的顺序比经验丹消息慢，而且经验丹消息是包含在伴侣消息一起发送的。最后丰哥提供了一个方案，以前也用来解决过这类顽固问题，就是在Character::run里面加一个定时器，这样可以设置进入之后，5秒内只执行一次相关的代码，我看了一下是游戏启动只执行一次，也就是大小退也是不会再执行的。不过感觉这个引擎封装的定时器不够好。
2. 迁移个性界面（动态和静态）是迁移过的项目里面目前为止最麻烦的一个，大半的不一致，看上去像重写一样。重制版没有魔盒，API不同，进阶界面的UI，玩家属性C界面的格子数量位置，图包的位置，代码整体结构的不同包括了免费版的那些进阶项目是全部统一写在魔盒内的Dlg，而重制版有的写在一起，有的没有，管理器都是单独的，好像展示的界面也没有，大片大片的不一样，刚上手的时候就感觉很麻烦。这种大片不一样的需要叫师傅来理清思路，然后再检查一遍。
其中的对个性界面图片位置的设置比较的麻烦，还是喜欢u3d,ue4那种可以在界面中直接改的风格，虽然也可以把位置写在配置文件中，动态的修改xml文件，相比之下还是麻烦了不少。现在的cocos creator也是往“所见即所得”的风格靠近，这种UI编辑器的确是老了。
3. 天气等级排行榜因为之前排行榜代码有不少，解决的比较快。但是牵扯出一个比较老的BUG，就是QQPanel控件的问题，本身不带滚动条，调用的函数不起作用，做了优化修改。

## 本周计划
1. 解决需求和自身知识完善。