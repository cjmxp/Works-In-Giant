[TOC]
## 段位赛轮盘逻辑修改
> 原因：因为这一套逻辑当初全部在客户端实现，所以后来发现了一个问题。原先的逻辑是：打完一局比赛之后，会同时比赛结算界面，确认关闭结算界面之后，会同时出现是否继续下局比赛和轮盘。如果你都点了轮盘抽奖和继续下一局，此时服务器卡了，场景切换到了下一局比赛地图，这个时候服务器去检查轮盘抽奖，去当前的场景中寻找该人物，会返回`nullptr`，就抽不了奖了，就是这样一个bug。


1. 段位赛结算之后，服务器会发送`stNewLevelPKGiveAwardCmd`这个消息。这个消息会置`m_jiesuan = 2`。
2. 段位赛结算的框里面，按了确定之后会弹框：是否要继续报名段位赛。**注意，这个时候服务器会发送`stRetLuckyDrawUICmd`消息**，这个消息会弹出轮盘。
3. 轮盘点了之后返回的消息是`stRetLuckyDrawResultCmd`，这个消息没啥作用，只是显示一个数值。

## Lua脚本的默认参数问题
- 龙星启耀的Lua接口，在原有的接口上增加了一个字段，声明时设置为默认参数，但是Lua脚本处不做修改，会报奔溃的错（但是游戏表现是正常，但是Decode调试时会报错）

## Media
> 这是一个解析媒体的一个项目，里面包含win32的自带媒体库（应该是，strmif.h文件,ddraw.h文件），但是这些个库我为什么搜不到相关的信息，好像也跟DX有关。

### 古老的音频相关代码
1. 包含的内容：`Movie，MoviePlayer播放器，MP3格式，Ogg格式阅读器，Scene场景音效，声音格式阅读器SoundBufferReader，SoundManager（这个为什么不放在Client项目里?是因为第三方吗，管理器不放一起吗？），VMR9 Video渲染（DX9实现的视频和图形呈现管道合并），Wav格式阅读器，Vorib编解码器，wxutil`
2. 这个项目，比较难看懂。多数是vs自带的库，或者第三方引用的相关文件。里面的宏定义`__IDvdGraphBuilder_FWD_DEFINED__`,`__IDrawVideoImage__FWD_DEFINED__`。
3. 这个声音的pos，为什么会有z坐标？这个读取Ogg格式的stream，已经很老的库了，里面的C还在用goto，97~01年的代码库。
4. 一共支持`mp3,ogg,wav`三种格式的音频文件。
5. 这个Media模块是在2018.12月加入的。**发现了，后面新加入的，但是属于旧的技术的模块，都是单独加出来在后面的**（好像也不对。。我不是很清楚这些实际加入时间）

## OleCtrl
> 这个项目的英文名称我都看不懂，里面的代码内容我也看不懂。
- 经过一番网上的查找，ole代表的是一种面向对象技术，利用这种技术可以开发可重复使用的软件组件。但是关于这一技术，是属于过去式了，微软已经宣布这一OLE已经不再代表对象链接与嵌入，仅仅是一个过去的名词。
- 这一套东西好像也没使用了。。。都没代码进入基类的构造函数
- 里面有`OleCtrls`为模式的控件，查找`Windows`句柄的窗口，`DxWebBrowser`这个好像最近雷神有用过，可能现在还在用。（最近修改防沉迷的时候有修改）
- 总结，现在就是一个浏览器。

## PinYin
> 这个模块就是简单的拼音搜索模块，属于第三方的库，看了一下实现逻辑，大概就是穷举法，列出来，没有模糊搜索功能。
1. 这一点，我在当时搜索道具，增加无限仓库的搜索功能时发现，也就是宽字节问题，被问到`hp`搜索时如何跳出魂魄类道具，当时一时语塞，没想到并没有限制只能跳出魂魄，还可以有其他道具，所以可以全列出，尽量模糊搜索。具体的算法，其他的算法，推荐搜索，或者去详细的看。